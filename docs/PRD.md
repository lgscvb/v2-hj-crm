# 叢林小管家 - 產品需求文件 (PRD)

> Product Requirements Document
> Version: 2.0
> Last Updated: 2024-12-22

---

## 1. 產品概述

### 1.1 產品名稱
**叢林小管家** (Hour Jungle CRM)

### 1.2 產品定位
專為**聯合辦公空間（虛擬辦公室）**設計的客戶關係管理系統，協助營運團隊高效管理客戶、合約、收款與日常營運事務。

### 1.3 產品願景
> 「讓每一位櫃台人員都能像資深經理一樣，掌握全局、高效處理」

透過 AI 輔助與自動化流程，降低人工作業負擔，提升營運效率。

### 1.4 核心價值主張

| 價值 | 說明 |
|------|------|
| **效率提升** | 自動產生繳費通知、續約提醒，減少手動追蹤 |
| **金流透明** | 即時掌握應收、已收、逾期款項 |
| **續約不漏** | Checklist 機制追蹤每份合約的續約進度 |
| **數據決策** | 報表中心提供營收分析，支援經營決策 |

---

## 2. 目標用戶

### 2.1 用戶角色 (Personas)

#### 角色 A：櫃台人員 (Front Desk)
- **日常任務**：接待客戶、處理繳費、安排會議室
- **痛點**：
  - 手動記錄容易遺漏
  - 不確定哪些客戶逾期
  - 續約通知時間難掌握
- **期望**：
  - 系統自動提醒待辦事項
  - 一鍵發送 LINE 催繳

#### 角色 B：分館經理 (Branch Manager)
- **日常任務**：監控營收、管理續約、追蹤業績
- **痛點**：
  - 需要手動彙整報表
  - 難以追蹤業務員佣金
  - 逾期款項追蹤費時
- **期望**：
  - Dashboard 一眼看完重要指標
  - 報表自動產生
  - 佣金計算自動化

#### 角色 C：系統管理員 (Admin)
- **日常任務**：設定系統參數、管理權限、維護資料
- **痛點**：
  - 價格方案調整需要工程師
  - 資料一致性難維護
- **期望**：
  - 自助式價格設定
  - 資料驗證工具

---

## 3. 核心功能

### 3.1 功能優先級分類

| P0 (必要) | P1 (重要) | P2 (優化) |
|-----------|-----------|-----------|
| 儀表板 | 報價單 | AI 助手 |
| 客戶管理 | 佣金管理 | 資料驗證 |
| 合約管理 | 會議室預約 | 潛客管理 |
| 繳費管理 | 平面圖 | 流失客戶分析 |
| 發票管理 | 存證信函 | |
| 續約提醒 | 報表中心 | |

### 3.2 功能詳述

---

#### 3.2.1 儀表板 (Dashboard) - P0

**目的**：提供營運概覽，讓用戶快速掌握重要指標與待辦事項。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| D-01 | 財務統計卡片 | 顯示本期應收、已收、未收、逾期金額 |
| D-02 | 今日會議室預約 | 顯示當日預約列表 |
| D-03 | 續約追蹤統計 | 顯示 45 天內到期合約的處理進度 |
| D-04 | 當月應催繳 | 列出待繳 + 逾期款項，支援一鍵催繳 |
| D-05 | 逾期款項提醒 | 列出逾期明細，顯示逾期天數 |
| D-06 | 今日待辦 | 自動彙整今日需處理事項 |
| D-07 | 分館營運概況 | 表格顯示各分館營收、待收、逾期 |
| D-08 | 自動通知開關 | 開啟/關閉自動發送催繳與續約通知 |

**驗收標準**：
- [ ] 頁面載入 < 3 秒
- [ ] 點擊「催繳」按鈕後，3 秒內發送 LINE 訊息
- [ ] 數據每 5 分鐘自動刷新

---

#### 3.2.2 客戶管理 (Customers) - P0

**目的**：集中管理所有客戶資料，支援快速搜尋與篩選。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| C-01 | 客戶列表 | 顯示客戶名稱、公司、分館、狀態 |
| C-02 | 搜尋篩選 | 支援姓名、公司、電話、分館篩選 |
| C-03 | 客戶詳情頁 | 顯示基本資料、合約歷史、繳費紀錄 |
| C-04 | 新增客戶 | 表單填寫基本資料 |
| C-05 | 編輯客戶 | 修改聯絡方式、備註 |
| C-06 | 流失客戶 | 查看已退租客戶名單 |
| C-07 | 自訂欄位顯示 | 選擇要顯示的欄位 |

**資料欄位**：
```
客戶資料
├── 基本資料
│   ├── 姓名 (required)
│   ├── 公司名稱
│   ├── 統一編號
│   ├── 電話 (required)
│   ├── Email
│   └── LINE ID
├── 合約資訊
│   ├── 所屬分館
│   ├── 合約狀態
│   └── 合約數量
└── 其他
    ├── 業務員（介紹人）
    └── 備註
```

---

#### 3.2.3 合約管理 (Contracts) - P0

**目的**：管理客戶合約的完整生命週期。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| CT-01 | 合約列表 | 顯示客戶、方案、金額、到期日、狀態 |
| CT-02 | 新增合約 | 選擇客戶 → 選擇方案 → 設定期間 |
| CT-03 | 合約詳情 | 顯示合約內容、繳費紀錄、發票紀錄 |
| CT-04 | 合約狀態管理 | 生效中 / 即將到期 / 已到期 / 已終止 |
| CT-05 | 合約續約 | 基於現有合約建立新合約 |
| CT-06 | 合約終止 | 記錄終止原因與日期 |
| CT-07 | 到期合約列表 | 獨立頁面查看已到期合約 |

**合約狀態流程**：
```
[草稿] → [生效中] → [即將到期(30天內)] → [已到期]
                ↓
            [已終止]
```

---

#### 3.2.4 繳費管理 (Payments) - P0

**目的**：追蹤每期款項的繳費狀態，支援催繳與記帳。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| P-01 | 繳費列表 | 顯示客戶、期數、金額、到期日、狀態 |
| P-02 | 記錄繳費 | 選擇付款方式、填寫實收金額、日期 |
| P-03 | 發送催繳 | 一鍵發送 LINE 繳費提醒 |
| P-04 | 撤銷繳費 | 取消已記錄的繳費（需填寫原因） |
| P-05 | 免收處理 | 標記為免收（需填寫原因） |
| P-06 | 繳費篩選 | 依狀態（待繳/已繳/逾期/免收）、分館篩選 |
| P-07 | 批量操作 | 批量發送催繳 |

**繳費狀態**：
```
[待繳 pending] → [已繳 paid]
       ↓
[逾期 overdue] → [已繳 paid]
       ↓
[免收 waived]
```

**付款方式**：
- 現金 (cash)
- 轉帳 (transfer)
- 信用卡 (credit_card)
- LINE Pay (line_pay)

---

#### 3.2.5 發票管理 (Invoices) - P0

**目的**：管理電子發票的開立與作廢。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| I-01 | 發票列表 | 顯示發票號碼、客戶、金額、狀態 |
| I-02 | 開立發票 | 自動串接光貿電子發票 API |
| I-03 | 作廢發票 | 作廢已開立發票 |
| I-04 | 重新開立 | 作廢後重新開立 |
| I-05 | 發票篩選 | 依月份、狀態篩選 |

**發票狀態**：
- 待開立 (pending)
- 待確認統編 (pending_tax_id)
- 已開立 (issued)
- 已作廢 (voided)

---

#### 3.2.6 續約提醒 (Renewals) - P0

**目的**：追蹤即將到期合約的續約流程。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| R-01 | 續約列表 | 顯示 45 天內到期的合約 |
| R-02 | 續約 Checklist | 追蹤 5 個步驟：通知、確認、繳費、開票、簽約 |
| R-03 | 發送續約通知 | 一鍵發送 LINE 續約提醒 |
| R-04 | 記錄續約進度 | 勾選完成的步驟 |
| R-05 | 批量發送 | 批量發送續約通知 |

**續約 Checklist**：
```
□ 已通知 (renewal_notified_at)
□ 已確認意願 (renewal_confirmed_at)
□ 已繳費 (renewal_paid_at)
□ 已開發票 (invoice_status)
□ 已簽約 (renewal_signed_at)
```

---

#### 3.2.7 報價單 (Quotes) - P1

**目的**：快速產生報價單供客戶參考。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| Q-01 | 報價單列表 | 顯示報價單編號、客戶、金額、狀態 |
| Q-02 | 建立報價單 | 選擇方案、設定優惠、產生報價 |
| Q-03 | 報價單詳情 | 顯示詳細內容 |
| Q-04 | 下載 PDF | 產生 PDF 格式報價單 |
| Q-05 | 公開連結 | 產生公開網址供客戶檢視 |
| Q-06 | 轉為合約 | 報價單確認後直接建立合約 |

---

#### 3.2.8 會議室預約 (Bookings) - P1

**目的**：管理會議室預約。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| B-01 | 預約列表 | 顯示日期、時段、會議室、客戶 |
| B-02 | 新增預約 | 選擇客戶、會議室、時段 |
| B-03 | 取消預約 | 取消並釋放時段 |
| B-04 | 日曆檢視 | 以日曆形式顯示預約 |
| B-05 | 衝突檢查 | 防止重複預約 |

---

#### 3.2.9 平面圖管理 (Floor Plan) - P1

**目的**：視覺化顯示各分館的座位分配。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| F-01 | 平面圖顯示 | 以圖形顯示座位配置 |
| F-02 | 座位狀態 | 標示已租用/空置座位 |
| F-03 | 座位指派 | 將座位指派給客戶 |
| F-04 | 匯出 PDF | 產生平面圖 + 租戶名冊 PDF |
| F-05 | 多分館切換 | 切換檢視不同分館 |

---

#### 3.2.10 佣金管理 (Commissions) - P1

**目的**：追蹤業務員的介紹佣金。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| CM-01 | 佣金列表 | 顯示業務員、客戶、佣金金額、狀態 |
| CM-02 | 佣金計算 | 依合約金額自動計算佣金 |
| CM-03 | 佣金發放 | 記錄佣金發放日期 |
| CM-04 | 佣金報表 | 彙整業務員佣金統計 |

---

#### 3.2.11 報表中心 (Reports) - P1

**目的**：提供營運數據分析報表。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| RP-01 | 營收報表 | 月/季/年營收趨勢 |
| RP-02 | 分館比較 | 各分館營收比較 |
| RP-03 | 客戶分析 | 客戶組成、流失率 |
| RP-04 | 逾期分析 | 逾期金額、天數統計 |
| RP-05 | 匯出報表 | 匯出 Excel/PDF |

---

#### 3.2.12 存證信函 (Legal Letters) - P1

**目的**：產生催款存證信函。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| L-01 | 信函列表 | 顯示已產生的存證信函 |
| L-02 | 產生信函 | 選擇客戶、自動帶入欠款資訊 |
| L-03 | 下載 PDF | 產生 PDF 格式存證信函 |

---

#### 3.2.13 AI 助手 (AI Assistant) - P2

**目的**：透過自然語言查詢 CRM 資料。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| AI-01 | 對話介面 | 輸入問題、顯示回答 |
| AI-02 | 資料查詢 | 「今天有哪些待繳款？」 |
| AI-03 | 操作執行 | 「發送催繳給 XXX」 |

---

#### 3.2.14 價格設定 (Service Plans) - P1

**目的**：設定各分館的服務方案與價格。

**功能需求**：

| ID | 功能 | 說明 |
|----|------|------|
| S-01 | 方案列表 | 顯示所有服務方案 |
| S-02 | 新增方案 | 設定名稱、價格、計費週期 |
| S-03 | 編輯方案 | 修改方案內容 |
| S-04 | 停用方案 | 停用不再使用的方案 |

---

## 4. User Stories

### 4.1 櫃台人員 Stories

```gherkin
US-001: 查看今日待辦
As a 櫃台人員
I want to 在儀表板看到今日待辦事項
So that 我可以優先處理緊急事務

Acceptance Criteria:
- 顯示今日到期的繳費
- 顯示今日的會議室預約
- 依優先級排序

---

US-002: 記錄客戶繳費
As a 櫃台人員
I want to 記錄客戶繳費
So that 繳費紀錄可以被追蹤

Acceptance Criteria:
- 選擇付款方式（現金/轉帳/信用卡/LINE Pay）
- 填寫實收金額
- 可選填備註
- 記錄成功後狀態更新為「已繳費」

---

US-003: 發送催繳通知
As a 櫃台人員
I want to 一鍵發送 LINE 催繳通知
So that 不需要手動打字發送

Acceptance Criteria:
- 點擊「催繳」按鈕
- 系統自動組合訊息（客戶名稱、金額、到期日）
- 透過 LINE 發送
- 顯示發送成功/失敗狀態

---

US-004: 查詢客戶資料
As a 櫃台人員
I want to 快速搜尋客戶
So that 我可以回答客戶的問題

Acceptance Criteria:
- 支援姓名、公司、電話搜尋
- 搜尋結果即時顯示
- 點擊進入客戶詳情頁
```

### 4.2 分館經理 Stories

```gherkin
US-101: 檢視營收概況
As a 分館經理
I want to 在儀表板看到本月營收統計
So that 我可以掌握營運狀況

Acceptance Criteria:
- 顯示本期應收總額
- 顯示本期已收總額
- 顯示逾期金額與筆數
- 可切換查看不同分館

---

US-102: 追蹤續約進度
As a 分館經理
I want to 追蹤每份合約的續約進度
So that 確保不會遺漏續約

Acceptance Criteria:
- 顯示 45 天內到期合約
- 每份合約有 5 步驟 Checklist
- 可篩選「急件」（7天內到期）

---

US-103: 產生營收報表
As a 分館經理
I want to 產生月度營收報表
So that 我可以向總部彙報

Acceptance Criteria:
- 選擇報表期間
- 顯示營收、待收、逾期明細
- 支援匯出 Excel
```

---

## 5. User Flow

### 5.1 核心流程

#### Flow 1: 客戶繳費流程
```
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│  繳費管理頁  │ ──→ │  選擇待繳款  │ ──→ │  記錄繳費    │
└──────────────┘     └──────────────┘     └──────────────┘
                                                  │
                                                  ↓
                     ┌──────────────┐     ┌──────────────┐
                     │  發票開立    │ ←── │  自動更新狀態 │
                     └──────────────┘     └──────────────┘
```

#### Flow 2: 續約流程
```
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│  續約提醒頁  │ ──→ │ 發送LINE通知 │ ──→ │ 客戶確認意願 │
└──────────────┘     └──────────────┘     └──────────────┘
                                                  │
        ┌─────────────────────────────────────────┘
        ↓
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│  繳費        │ ──→ │  開立發票    │ ──→ │  簽訂新約    │
└──────────────┘     └──────────────┘     └──────────────┘
```

#### Flow 3: 新客戶簽約流程
```
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│  潛客洽談    │ ──→ │  建立報價單  │ ──→ │  客戶確認    │
└──────────────┘     └──────────────┘     └──────────────┘
                                                  │
        ┌─────────────────────────────────────────┘
        ↓
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│  建立客戶    │ ──→ │  建立合約    │ ──→ │  收取首期款  │
└──────────────┘     └──────────────┘     └──────────────┘
```

---

## 6. 非功能性需求 (NFR)

### 6.1 效能需求

| 指標 | 目標值 |
|------|--------|
| 頁面載入時間 | < 3 秒 |
| API 回應時間 | < 500ms |
| 並發用戶數 | 50+ |
| 資料庫查詢 | < 100ms |

### 6.2 安全需求

| 需求 | 說明 |
|------|------|
| 資料加密 | HTTPS 傳輸、敏感資料加密儲存 |
| 存取控制 | 依角色限制功能權限 |
| 稽核紀錄 | 記錄重要操作（繳費、合約變更） |

### 6.3 可用性需求

| 需求 | 說明 |
|------|------|
| 響應式設計 | 支援桌機、平板操作 |
| 錯誤處理 | 友善的錯誤訊息 |
| Loading 狀態 | 操作時顯示載入指示 |

### 6.4 相容性需求

| 項目 | 支援範圍 |
|------|----------|
| 瀏覽器 | Chrome 90+, Safari 14+, Edge 90+ |
| 螢幕解析度 | 1280x720 以上 |

---

## 7. 整合需求

### 7.1 外部服務整合

| 服務 | 用途 | 狀態 |
|------|------|------|
| LINE Messaging API | 發送通知、催繳訊息 | ✅ 已整合 |
| 光貿電子發票 | 開立電子發票 | ✅ 已整合 |
| Google Calendar | 會議室預約同步（規劃中） | 🔲 待整合 |

### 7.2 內部服務整合

| 服務 | 用途 |
|------|------|
| Brain AI 客服 | LINE Bot 自動回覆 |
| PDF Generator | 報價單、合約、平面圖 PDF 生成 |

---

## 8. 未來規劃

### Phase 2 功能規劃

| 功能 | 優先級 | 說明 |
|------|--------|------|
| 權限管理 | High | 細緻的角色權限設定 |
| 自動化排程 | High | 定時發送催繳/續約通知 |
| 合約電子簽章 | Medium | 線上簽約流程 |
| 行動版 App | Medium | iOS/Android App |
| 財務對帳 | Low | 與銀行帳戶對帳 |

---

## 9. 名詞定義

| 名詞 | 定義 |
|------|------|
| 分館 (Branch) | Hour Jungle 的各個營業據點 |
| 服務方案 (Service Plan) | 租用的服務類型（虛擬辦公室、固定座位等） |
| 繳費期 (Payment Period) | 每期繳費的時間區間，如 2024-12 |
| 續約 Checklist | 追蹤續約 5 步驟：通知、確認、繳費、開票、簽約 |
| 介紹人 (Referrer) | 介紹客戶的業務員，可獲得佣金 |

---

## 10. 文件版本歷史

| 版本 | 日期 | 變更說明 | 作者 |
|------|------|----------|------|
| 1.0 | 2024-01-01 | 初版 | - |
| 2.0 | 2024-12-22 | 完整重寫，新增 User Stories、User Flow | Claude |

---

## 附錄

### A. 資料庫主要實體關係

```
Branches (分館)
    ↓ 1:N
Customers (客戶)
    ↓ 1:N
Contracts (合約)
    ↓ 1:N
Payments (繳費)
    ↓ 1:1
Invoices (發票)
```

### B. 權限矩陣（規劃中）

| 功能 | Admin | Manager | Finance | Service |
|------|-------|---------|---------|---------|
| 儀表板 | ✅ | ✅ | ✅ | ✅ |
| 客戶管理 | ✅ | ✅ | 📖 | ✅ |
| 合約管理 | ✅ | ✅ | 📖 | 📖 |
| 繳費管理 | ✅ | ✅ | ✅ | ✅ |
| 報表中心 | ✅ | ✅ | ✅ | ❌ |
| 系統設定 | ✅ | ❌ | ❌ | ❌ |

✅ 完整權限 | 📖 唯讀 | ❌ 無權限
